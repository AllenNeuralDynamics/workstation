<!DOCTYPE html>
<html>
<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
<body>

<div ng-app="myApp" ng-controller="myCtrl">

    <p><span ng-bind="serverUrl"/></p>

    <div ng-show="isMode('initialize')">
        <h1>Loading...</h1>
    </div>

    <div ng-show="isMode('currentServices')">
        <h1>Current Services</h1>
        <p>count={{currentServices.length}}</p>
        <table>
            <tr ng-repeat="x in currentServices | orderBy:'createTimestamp'">
                <td>{{x.ownerName}}</td>
                <td>{{x.name}}</td>
                <td>{{x.createTimeString}}</td>
                <td>{{x.state}}</td>
            </tr>
        </table>

    </div>

</div>


<script>
    var app = angular.module('myApp', []);
    app.controller('myCtrl', function($scope, $http, $location) {

        $scope.serverUrl = "http://" + $location.host() + ":" + $location.port();

        //  $scope.serverUrl="http://h01u03.int.janelia.org:8180";

        $scope.mode="initialize";

        $scope.isMode = function(m) {
            if ($scope.mode == m) {
                return true;
            }
            return false;
        }

        $scope.switchToMode = function(m) {
            $scope.mode=m;
        }

        $http.get($scope.serverUrl + "/rest-v1/jacsv2/currentServices")
            .then(function(response) {
                $scope.currentServices = response.data;
                $scope.mode="currentServices";
            });

    });
</script>

</body>
</html>
